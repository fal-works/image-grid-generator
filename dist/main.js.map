{"version":3,"file":"main.js","sources":["../src/main.ts"],"sourcesContent":["import p5 from \"p5\";\r\n\r\nlet p: p5;\r\nlet dropzone: p5.Element;\r\nconst originalImages: p5.Element[] = [];\r\nconst originalImageColumns = 10;\r\nconst thumbnailSize = 960 / 10;\r\n\r\nlet gridImage: p5.Graphics | undefined = undefined;\r\n\r\nfunction highlight() {\r\n  dropzone.style(\"background-color\", \"#ccc\");\r\n}\r\n\r\nfunction unhighlight() {\r\n  dropzone.style(\"background-color\", \"#fff\");\r\n}\r\n\r\nconst addImage = (file: p5.File) => {\r\n  if (file.type !== \"image\") return;\r\n\r\n  const thumbnail = p.createImg(file.data, file.name, () => {\r\n    if (!thumbnail) return;\r\n\r\n    const originalSize = thumbnail.size() as { width: number; height: number };\r\n    const { width, height } = originalSize;\r\n    const scaleFactor = thumbnailSize / Math.max(width, height);\r\n\r\n    thumbnail.size(width * scaleFactor, height * scaleFactor);\r\n\r\n    const thumbnailRow = Math.floor(\r\n      originalImages.length / originalImageColumns\r\n    );\r\n    const thumbnailColumn = originalImages.length % originalImageColumns;\r\n    thumbnail.position(\r\n      thumbnailSize * thumbnailColumn,\r\n      30 + thumbnailSize * thumbnailRow\r\n    );\r\n  });\r\n\r\n  const img = p.createImg(file.data, undefined, () => {\r\n    if (!img) {\r\n      console.warn(`\"Failed to load ${file.name}`);\r\n      return;\r\n    }\r\n\r\n    img.hide();\r\n\r\n    originalImages.push(img);\r\n  });\r\n};\r\n\r\nconst generate = () => {\r\n  p.background(255);\r\n\r\n  const g = p.createGraphics(960, 960);\r\n  const rows = 3;\r\n  const columns = 3;\r\n\r\n  const cellWidth = g.width / columns;\r\n  const cellHeight = g.height / rows;\r\n\r\n  const images: p5.Element[] = p.shuffle(originalImages);\r\n\r\n  for (let row = 0; row < rows; row += 1) {\r\n    const y = row * cellHeight;\r\n    for (let column = 0; column < columns; column += 1) {\r\n      const image = images.pop();\r\n      if (!image) break;\r\n      const x = column * cellWidth;\r\n      g.image(image, x, y, cellWidth, cellHeight);\r\n    }\r\n  }\r\n\r\n  p.image(g, p.width / 2 - 480 / 2, p.height / 2, 480, 480);\r\n\r\n  gridImage = g;\r\n};\r\n\r\nconst saveResult = () => {\r\n  if (!gridImage) return;\r\n\r\n  p.save(gridImage, `grid-image.png`);\r\n};\r\n\r\nconst setup = () => {\r\n  p.createCanvas(960, 960);\r\n\r\n  dropzone = p.createDiv();\r\n  dropzone.position(0, 0);\r\n  dropzone.size(p.width, p.height / 2);\r\n  dropzone.dragOver(highlight);\r\n  dropzone.dragLeave(unhighlight);\r\n  dropzone.drop(addImage, unhighlight);\r\n\r\n  const generateButton = p.createButton(\"generate\");\r\n  generateButton.mouseClicked(generate);\r\n  generateButton.position(0, 5);\r\n  generateButton.size(100, 25);\r\n\r\n  const saveButton = p.createButton(\"save\");\r\n  saveButton.mouseClicked(saveResult);\r\n  saveButton.position(120, 5);\r\n  saveButton.size(80, 25);\r\n};\r\n\r\nnew p5(p5Instance => {\r\n  p = p5Instance;\r\n  p.setup = setup;\r\n});\r\n"],"names":[],"mappings":"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"}