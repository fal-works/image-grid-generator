{"version":3,"file":"main.js","sources":["../src/shared.ts","../src/dom/utility.ts","../src/dom/drop-zone.ts","../src/dom/button.ts","../src/dom/img-element.ts","../src/dom/text-area.ts","../src/settings.ts","../src/thumbnail-area.ts","../src/parameters.ts","../src/image-grid.ts","../src/guide.ts","../src/main.ts"],"sourcesContent":["import p5 from \"p5\";\r\n\r\nexport let p: p5;\r\n\r\nexport const setP5Instance = (p5Instance: p5) => (p = p5Instance);\r\n","import p5 from \"p5\";\r\nimport { Position, RectangleSize } from \"../types\";\r\n\r\nexport const getSize = (element: p5.Element) =>\r\n  element.size() as {\r\n    width: number;\r\n    height: number;\r\n  };\r\n\r\nexport const fitToBox = (element: p5.Element, boxSize: RectangleSize) => {\r\n  const { width, height } = getSize(element);\r\n  const scaleFactor = Math.min(boxSize.width / width, boxSize.height / height);\r\n  element.size(width * scaleFactor, height * scaleFactor);\r\n};\r\n\r\ntype PositionType = \"static\" | \"absolute\" | \"relative\" | \"fixed\";\r\nconst positionTypes = {\r\n  static: \"static\" as PositionType,\r\n  absolute: \"absolute\" as PositionType,\r\n  relative: \"relative\" as PositionType,\r\n  fixed: \"fixed\" as PositionType\r\n};\r\n\r\nexport const setPosition = (\r\n  element: p5.Element,\r\n  position: Position,\r\n  type: PositionType = positionTypes.absolute\r\n) => {\r\n  const style = element.elt.style;\r\n  const { x, y } = position;\r\n\r\n  style.position = type;\r\n  style.left = `${x}px`;\r\n  style.top = `${y}px`;\r\n\r\n  return element;\r\n};\r\n\r\nexport const setInBox = (\r\n  element: p5.Element,\r\n  boxPosition: Position,\r\n  boxSize: RectangleSize\r\n) => {\r\n  fitToBox(element, boxSize);\r\n\r\n  const size = getSize(element);\r\n  setPosition(element, {\r\n    x: boxPosition.x + (boxSize.width - size.width) / 2,\r\n    y: boxPosition.y + (boxSize.height - size.height) / 2\r\n  });\r\n};\r\n","import p5 from \"p5\";\r\nimport { p } from \"../shared\";\r\nimport { Position, RectangleSize } from \"../types\";\r\nimport { setPosition } from \"./utility\";\r\n\r\nexport const create = (parameters: {\r\n  position: Position;\r\n  size: RectangleSize;\r\n  onDrop: (file: p5.File) => void;\r\n}) => {\r\n  const { position, size, onDrop } = parameters;\r\n\r\n  const dropZone = p.createDiv(\"Drop image files here\");\r\n\r\n  const highlight = () => dropZone.style(\"background-color\", \"#F0FAFF\");\r\n  const unhighlight = () => dropZone.style(\"background-color\", \"#FDFDFD\");\r\n\r\n  setPosition(dropZone, position).size(size.width, size.height);\r\n\r\n  dropZone.addClass(\"drop-zone\");\r\n\r\n  dropZone\r\n    .dragOver(highlight)\r\n    .dragLeave(unhighlight)\r\n    .drop(onDrop, () => {\r\n      unhighlight();\r\n      dropZone.elt.innerHTML = \"\";\r\n    });\r\n\r\n  unhighlight();\r\n\r\n  return dropZone;\r\n};\r\n","import { p } from \"../shared\";\r\nimport { setPosition } from \"./utility\";\r\n\r\nexport const create = (parameters: {\r\n  label: string;\r\n  onClick: () => void;\r\n  position: { x: number; y: number };\r\n  size: { width: number; height: number };\r\n}) => {\r\n  const { label, onClick, position, size } = parameters;\r\n\r\n  const button = p.createButton(label);\r\n  button.mouseClicked(onClick);\r\n  setPosition(button, position);\r\n  button.size(size.width, size.height);\r\n\r\n  return button;\r\n};\r\n","import p5 from \"p5\";\r\nimport { p } from \"../shared\";\r\n\r\nexport const create = (parameters: {\r\n  file: p5.File;\r\n  alt?: string;\r\n  hide?: boolean;\r\n  onLoad?: (img: p5.Element, file: p5.File) => void;\r\n  onFail?: (file: p5.File) => void;\r\n  warnOnFail?: boolean;\r\n}) => {\r\n  const {\r\n    file: { data: url },\r\n    alt,\r\n    hide\r\n  } = parameters;\r\n\r\n  const img = p.createImg(url, alt, () => {\r\n    const { file, warnOnFail, onLoad, onFail } = parameters;\r\n\r\n    if (!img) {\r\n      if (warnOnFail) console.warn(`\"Failed to load ${file.name}`);\r\n      if (onFail) onFail(file);\r\n      return;\r\n    }\r\n\r\n    if (onLoad) onLoad(img, file);\r\n  });\r\n\r\n  if (hide) img.hide();\r\n\r\n  return img;\r\n};\r\n\r\nconst returnVoid = () => {\r\n  return;\r\n};\r\nconst returnUndefined = () => undefined;\r\n\r\nexport const createList = (parameters: {\r\n  files: readonly p5.File[];\r\n  getAlt?: (file: p5.File) => string | undefined;\r\n  hide?: boolean;\r\n  onLoadEach?: (img: p5.Element, file: p5.File, index: number) => void;\r\n  onFailEach?: (file: p5.File, index: number) => void;\r\n  warnOnFail?: boolean;\r\n  onComplete?: (imgList: p5.Element[]) => void;\r\n}) => {\r\n  const { files, hide, warnOnFail } = parameters;\r\n  const getAlt = parameters.getAlt || returnUndefined;\r\n  const onLoadEach = parameters.onLoadEach || returnVoid;\r\n  const onFailEach = parameters.onFailEach || returnVoid;\r\n  const onComplete = parameters.onComplete || returnVoid;\r\n  const fileCount = files.length;\r\n\r\n  const loadedImages: p5.Element[] = [];\r\n\r\n  for (let i = 0; i < files.length; i += 1) {\r\n    const file = files[i];\r\n    create({\r\n      file,\r\n      alt: getAlt(file),\r\n      hide,\r\n      onLoad: (img, file) => {\r\n        onLoadEach(img, file, i);\r\n        loadedImages.push(img);\r\n        if (loadedImages.length === fileCount) onComplete(loadedImages);\r\n      },\r\n      onFail: file => onFailEach(file, i),\r\n      warnOnFail\r\n    });\r\n  }\r\n\r\n  return loadedImages;\r\n};\r\n","import { p } from \"../shared\";\r\nimport { Position, RectangleSize } from \"../types\";\r\nimport { setPosition } from \"./utility\";\r\n\r\nexport const create = (parameters: {\r\n  readonly position: Position;\r\n  readonly size: RectangleSize;\r\n  readonly initialValue?: string;\r\n}) => {\r\n  const { position, size, initialValue } = parameters;\r\n\r\n  const area = p.createElement(\"textarea\", initialValue);\r\n\r\n  setPosition(area, position).size(size.width, size.height);\r\n\r\n  return area;\r\n};\r\n","import { Position, RectangleSize } from \"./types\";\r\n\r\nconst wholeSize: RectangleSize = {\r\n  width: 1280,\r\n  height: 800\r\n};\r\n\r\nexport const leftZonePosition: Position = {\r\n  x: 0,\r\n  y: 0\r\n};\r\n\r\nexport const leftZoneSize: RectangleSize = {\r\n  width: wholeSize.width - wholeSize.height,\r\n  height: wholeSize.height\r\n};\r\n\r\nconst leftZoneRightPadding = 20;\r\n\r\nconst leftZoneInterval = 20;\r\n\r\n// -- drop zone ----\r\n\r\nexport const dropZonePosition: Position = {\r\n  x: leftZonePosition.x,\r\n  y: leftZonePosition.y\r\n};\r\n\r\nexport const dropZoneSize: RectangleSize = {\r\n  width: leftZoneSize.width - leftZoneRightPadding,\r\n  height: 420\r\n};\r\n\r\nconst thumnailAreaMargin = 1;\r\n\r\nexport const thumbnailAreaPosition: Position = {\r\n  x: dropZonePosition.x + thumnailAreaMargin,\r\n  y: dropZonePosition.y + thumnailAreaMargin\r\n};\r\n\r\nexport const thumbnailAreaSize: RectangleSize = {\r\n  width: dropZoneSize.width - 2 * thumnailAreaMargin,\r\n  height: dropZoneSize.height - 2 * thumnailAreaMargin\r\n};\r\n\r\n// -- buttons ----\r\n\r\nexport const generateButtonPosition: Position = {\r\n  x: leftZonePosition.x,\r\n  y: dropZonePosition.y + dropZoneSize.height + leftZoneInterval\r\n};\r\n\r\nconst buttonHeight = 40;\r\nconst buttonHorizontalInterval = 16;\r\n\r\nexport const generateButtonSize: RectangleSize = {\r\n  width: 120,\r\n  height: buttonHeight\r\n};\r\n\r\nexport const saveButtonPosition: Position = {\r\n  x:\r\n    generateButtonPosition.x +\r\n    buttonHorizontalInterval +\r\n    generateButtonSize.width,\r\n  y: generateButtonPosition.y\r\n};\r\n\r\nexport const saveButtonSize: RectangleSize = {\r\n  width: 120,\r\n  height: buttonHeight\r\n};\r\n\r\n// -- parameter area ----\r\n\r\nexport const parameterAreaPosition: Position = {\r\n  x: leftZonePosition.x,\r\n  y: generateButtonPosition.y + buttonHeight + leftZoneInterval\r\n};\r\n\r\nexport const parameterAreaSize: RectangleSize = {\r\n  width: leftZoneSize.width - leftZoneRightPadding,\r\n  height:\r\n    leftZoneSize.height -\r\n    (dropZoneSize.height + leftZoneInterval + buttonHeight + leftZoneInterval)\r\n};\r\n\r\n// -- canvas ----\r\n\r\nexport const canvasSize: RectangleSize = {\r\n  width: wholeSize.width - leftZoneSize.width,\r\n  height: wholeSize.height\r\n};\r\n\r\nexport const canvasPosition: Position = {\r\n  x: leftZoneSize.width,\r\n  y: 0\r\n};\r\n","import p5 from \"p5\";\r\nimport { Position, RectangleSize } from \"./types\";\r\nimport * as DomUtility from \"./dom/utility\";\r\nimport * as ImgElement from \"./dom/img-element\";\r\n\r\nexport interface Unit {\r\n  readonly position: Position;\r\n  size: RectangleSize;\r\n  columns: number;\r\n  cellSize: RectangleSize;\r\n  readonly elements: p5.Element[];\r\n}\r\n\r\nexport const create = (parameters: {\r\n  position: Position;\r\n  size: RectangleSize;\r\n  initialColumns: number;\r\n}): Unit => {\r\n  const { position, size, initialColumns: columns } = parameters;\r\n  const cellWidth = size.width / columns;\r\n\r\n  return {\r\n    position,\r\n    size,\r\n    columns,\r\n    cellSize: { width: cellWidth, height: cellWidth },\r\n    elements: []\r\n  };\r\n};\r\n\r\nconst setElement = (\r\n  element: p5.Element,\r\n  index: number,\r\n  areaPosition: Position,\r\n  columns: number,\r\n  cellSize: RectangleSize\r\n) => {\r\n  const row = Math.floor(index / columns);\r\n  const column = index % columns;\r\n  const boxPosition = {\r\n    x: areaPosition.x + cellSize.width * column,\r\n    y: areaPosition.y + cellSize.height * row\r\n  };\r\n  DomUtility.setInBox(element, boxPosition, cellSize);\r\n};\r\n\r\nexport const changeColumns = (area: Unit, columns: number) => {\r\n  const { position: areaPosition, size, elements } = area;\r\n  area.columns = columns;\r\n\r\n  const cellWidth = size.width / columns;\r\n  area.cellSize = { width: cellWidth, height: cellWidth };\r\n\r\n  for (let index = 0; index < elements.length; index += 1)\r\n    setElement(elements[index], index, areaPosition, columns, area.cellSize);\r\n};\r\n\r\nconst onLoad = (area: Unit, thumbnail: p5.Element) => {\r\n  const { position, size, cellSize, columns, elements } = area;\r\n\r\n  thumbnail.show();\r\n  setElement(thumbnail, elements.length, position, columns, cellSize);\r\n\r\n  area.elements.push(thumbnail);\r\n\r\n  const actualHeight = Math.ceil(elements.length / columns) * cellSize.height;\r\n\r\n  if (actualHeight > size.height) changeColumns(area, columns + 1);\r\n};\r\n\r\nexport const add = (\r\n  area: Unit,\r\n  file: p5.File,\r\n  onComplete: (img: p5.Element, file: p5.File) => void\r\n) => {\r\n  if (file.type !== \"image\") {\r\n    console.warn(`Dropped file that is not an image:`, file);\r\n    return;\r\n  }\r\n\r\n  ImgElement.create({\r\n    file,\r\n    alt: file.name,\r\n    onLoad: (img, file) => {\r\n      onLoad(area, img);\r\n      onComplete(img, file);\r\n    }\r\n  }).hide();\r\n};\r\n","type OuterMargin = {\r\n  readonly top: number;\r\n  readonly bottom: number;\r\n  readonly left: number;\r\n  readonly right: number;\r\n};\r\n\r\nexport type Unit = {\r\n  readonly width: number;\r\n  readonly height: number;\r\n  readonly columns: number;\r\n  readonly rows: number;\r\n  readonly outerMargin: OuterMargin;\r\n  readonly innerMargin: number;\r\n  readonly backgroundColorCode: string;\r\n};\r\n\r\nexport const defaultValues: Unit = {\r\n  width: 800,\r\n  height: 800,\r\n  columns: 2,\r\n  rows: 2,\r\n  outerMargin: {\r\n    top: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0\r\n  },\r\n  innerMargin: 0,\r\n  backgroundColorCode: \"#FFFFFF00\"\r\n};\r\n\r\nexport const stringify = (parameters: Unit) =>\r\n  JSON.stringify(parameters, undefined, 2);\r\n\r\nexport const defaultString = stringify(defaultValues);\r\n\r\nconst reviver = (key: string, value: any) =>\r\n  key === \"\" ||\r\n  Number.isFinite(value) ||\r\n  (typeof value === \"object\" && !Array.isArray(value)) ||\r\n  typeof value === \"string\"\r\n    ? value\r\n    : undefined;\r\n\r\nconst validateNumber = (value: any, defaultValue: number): number =>\r\n  Number.isFinite(value) && value < 10000 ? value : defaultValue;\r\n\r\nconst validateString = (value: any, defaultValue: string): string =>\r\n  typeof value === \"string\" ? value : defaultValue;\r\n\r\nconst validateOuterMargin = (parsed: any): OuterMargin => {\r\n  const defaultMargin = defaultValues.outerMargin;\r\n\r\n  if (typeof parsed === \"number\") {\r\n    const margin = validateNumber(parsed, defaultMargin.top);\r\n\r\n    return {\r\n      top: margin,\r\n      bottom: margin,\r\n      left: margin,\r\n      right: margin\r\n    };\r\n  }\r\n\r\n  return {\r\n    top: validateNumber(parsed.top, defaultMargin.top),\r\n    bottom: validateNumber(parsed.bottom, defaultMargin.bottom),\r\n    left: validateNumber(parsed.left, defaultMargin.left),\r\n    right: validateNumber(parsed.right, defaultMargin.right)\r\n  };\r\n};\r\n\r\nconst validate = (parsed: any): Unit => {\r\n  const width = validateNumber(parsed.width, defaultValues.width);\r\n  const height = validateNumber(parsed.height, defaultValues.height);\r\n  const columns = validateNumber(parsed.columns, defaultValues.columns);\r\n  const rows = validateNumber(parsed.rows, defaultValues.rows);\r\n\r\n  const outerMargin = validateOuterMargin(parsed.outerMargin);\r\n\r\n  const innerMargin = validateNumber(\r\n    parsed.innerMargin,\r\n    defaultValues.innerMargin\r\n  );\r\n\r\n  const backgroundColorCode = validateString(\r\n    parsed.backgroundColorCode,\r\n    defaultValues.backgroundColorCode\r\n  );\r\n\r\n  return {\r\n    width,\r\n    height,\r\n    columns,\r\n    rows,\r\n    outerMargin,\r\n    innerMargin,\r\n    backgroundColorCode\r\n  };\r\n};\r\n\r\nexport const parse = (jsonString: string): Unit => {\r\n  if (typeof jsonString !== \"string\") return defaultValues;\r\n\r\n  try {\r\n    return validate(JSON.parse(jsonString, reviver));\r\n  } catch (_) {\r\n    return defaultValues;\r\n  }\r\n};\r\n\r\nexport const calculate = (parameters: Unit) => {\r\n  const { width, height, columns, rows, outerMargin, innerMargin } = parameters;\r\n\r\n  const contentWidth = parameters.width - outerMargin.left - outerMargin.right;\r\n  const contentHeight =\r\n    parameters.height - outerMargin.top - outerMargin.bottom;\r\n\r\n  const contentLeftX = outerMargin.left;\r\n  const contentTopY = outerMargin.top;\r\n  const contentRightX = width - outerMargin.right;\r\n  const contentBottomY = height - outerMargin.bottom;\r\n\r\n  const columnWidth = contentWidth / columns;\r\n  const rowHeight = contentHeight / rows;\r\n\r\n  const cellWidth = (contentWidth - (columns - 1) * innerMargin) / columns;\r\n  const cellHeight = (contentHeight - (rows - 1) * innerMargin) / rows;\r\n\r\n  return {\r\n    contentWidth,\r\n    contentHeight,\r\n    contentLeftX,\r\n    contentTopY,\r\n    contentRightX,\r\n    contentBottomY,\r\n    columnWidth,\r\n    rowHeight,\r\n    cellWidth,\r\n    cellHeight\r\n  };\r\n};\r\n","import p5 from \"p5\";\r\nimport { p } from \"./shared\";\r\nimport * as Parameters from \"./parameters\";\r\n\r\nexport const create = (\r\n  images: readonly p5.Image[] | readonly p5.Element[],\r\n  parameters: Parameters.Unit\r\n) => {\r\n  const {\r\n    width: graphicsWidth,\r\n    height: graphicsHeight,\r\n    rows,\r\n    columns,\r\n    outerMargin,\r\n    innerMargin,\r\n    backgroundColorCode\r\n  } = parameters;\r\n  const imageCount = images.length;\r\n\r\n  const { cellWidth, cellHeight } = Parameters.calculate(parameters);\r\n\r\n  const graphics = p.createGraphics(graphicsWidth, graphicsHeight);\r\n  const backgroundColor = p.color(backgroundColorCode);\r\n  if (p.alpha(backgroundColor) > 0) graphics.background(backgroundColor);\r\n\r\n  graphics.push();\r\n  graphics.imageMode(p.CENTER);\r\n  graphics.translate(\r\n    outerMargin.left + cellWidth / 2,\r\n    outerMargin.top + cellHeight / 2\r\n  );\r\n\r\n  let imageIndex = 0;\r\n\r\n  for (\r\n    let row = 0, y = 0;\r\n    row < rows;\r\n    row += 1, y += cellHeight + innerMargin\r\n  ) {\r\n    for (\r\n      let column = 0, x = 0;\r\n      column < columns;\r\n      column += 1, x += cellWidth + innerMargin\r\n    ) {\r\n      if (imageIndex >= imageCount) break;\r\n\r\n      const image = images[imageIndex++];\r\n      const imageWidth = (image as any).width as number;\r\n      const imageHeight = (image as any).height as number;\r\n      const scaleFactor = Math.min(\r\n        cellWidth / imageWidth,\r\n        cellHeight / imageHeight\r\n      );\r\n      graphics.image(\r\n        image,\r\n        x,\r\n        y,\r\n        scaleFactor * imageWidth,\r\n        scaleFactor * imageHeight\r\n      );\r\n    }\r\n  }\r\n\r\n  graphics.pop();\r\n\r\n  return graphics;\r\n};\r\n","import { p } from \"./shared\";\r\nimport * as Parameters from \"./parameters\";\r\n\r\nexport const draw = (parameters: Parameters.Unit) => {\r\n  const { width, height, columns, rows, innerMargin } = parameters;\r\n\r\n  const {\r\n    contentWidth,\r\n    contentHeight,\r\n    contentLeftX,\r\n    contentTopY,\r\n    contentRightX,\r\n    contentBottomY,\r\n    columnWidth,\r\n    rowHeight,\r\n    cellWidth,\r\n    cellHeight\r\n  } = Parameters.calculate(parameters);\r\n\r\n  p.push();\r\n  p.translate((p.width - width) / 2, (p.height - height) / 2);\r\n  p.stroke(255, 64, 128);\r\n  p.noFill();\r\n\r\n  p.rect(1, 1, width - 2, height - 2);\r\n  p.rect(\r\n    contentLeftX + 1,\r\n    contentTopY + 1,\r\n    contentWidth - 2,\r\n    contentHeight - 2\r\n  );\r\n\r\n  if (innerMargin <= 0) {\r\n    for (let i = 1, x = contentLeftX; i < columns; i += 1) {\r\n      x += columnWidth;\r\n      p.line(x, contentTopY, x, contentBottomY);\r\n    }\r\n    for (let i = 1, y = contentTopY; i < rows; i += 1) {\r\n      y += rowHeight;\r\n      p.line(contentLeftX, y, contentRightX, y);\r\n    }\r\n  } else {\r\n    for (let i = 1, x = contentLeftX; i < columns; i += 1) {\r\n      x += cellWidth;\r\n      p.line(x, contentTopY, x, contentBottomY);\r\n      x += innerMargin;\r\n      p.line(x, contentTopY, x, contentBottomY);\r\n    }\r\n    for (let i = 1, y = contentTopY; i < rows; i += 1) {\r\n      y += cellHeight;\r\n      p.line(contentLeftX, y, contentRightX, y);\r\n      y += innerMargin;\r\n      p.line(contentLeftX, y, contentRightX, y);\r\n    }\r\n  }\r\n\r\n  p.pop();\r\n};\r\n","import p5 from \"p5\";\r\nimport { p, setP5Instance } from \"./shared\";\r\nimport * as DropZone from \"./dom/drop-zone\";\r\nimport * as Button from \"./dom/button\";\r\nimport * as ImgElement from \"./dom/img-element\";\r\nimport * as TextArea from \"./dom/text-area\";\r\nimport { setPosition } from \"./dom/utility\";\r\nimport * as Settings from \"./settings\";\r\nimport * as ThumbnailArea from \"./thumbnail-area\";\r\nimport * as ImageGrid from \"./image-grid\";\r\nimport * as Parameters from \"./parameters\";\r\nimport * as Guide from \"./guide\";\r\n\r\n// ---- variables -------------------------------------------------------------\r\n\r\nconst imageFiles: p5.File[] = [];\r\n\r\nlet gridImage: p5.Graphics | undefined = undefined;\r\nlet parameterArea: p5.Element;\r\nlet guideMode = false;\r\nlet processing = false;\r\nlet drawGeneratedGrid = () => {\r\n  p.background(255);\r\n  p.push();\r\n  p.stroke(224);\r\n  p.noFill();\r\n  p.strokeWeight(1);\r\n  p.rect(1, 1, p.width - 2, p.height - 2);\r\n  p.pop();\r\n};\r\n\r\n// ---- functions -------------------------------------------------------------\r\n\r\nconst startProcessing = () => {\r\n  processing = true;\r\n  p.cursor(p.WAIT);\r\n};\r\n\r\nconst endProcessing = () => {\r\n  processing = false;\r\n  p.cursor(p.ARROW);\r\n};\r\n\r\nconst completeGenerate = (parameters: Parameters.Unit) => (\r\n  imgList: readonly p5.Element[]\r\n) => {\r\n  if (imgList.length <= 0) {\r\n    endProcessing();\r\n    return;\r\n  }\r\n\r\n  const grid = ImageGrid.create(imgList, parameters);\r\n\r\n  const scaleFactor = Math.min(\r\n    1,\r\n    Math.min(p.width / grid.width, p.height / grid.height)\r\n  );\r\n  const displayWidth = scaleFactor * grid.width;\r\n  const displayHeight = scaleFactor * grid.height;\r\n\r\n  drawGeneratedGrid = () => {\r\n    p.background(255);\r\n    p.image(grid, p.width / 2, p.height / 2, displayWidth, displayHeight);\r\n  };\r\n\r\n  drawGeneratedGrid();\r\n\r\n  gridImage = grid;\r\n  endProcessing();\r\n};\r\n\r\nconst startGenerate = () => {\r\n  if (processing) return;\r\n\r\n  const parameters = Parameters.parse(parameterArea.value().toString());\r\n  const cellCount = parameters.rows * parameters.columns;\r\n  if (cellCount < 1) return;\r\n\r\n  processing = true;\r\n  startProcessing();\r\n\r\n  const files: p5.File[] = p.shuffle(imageFiles).slice(0, cellCount);\r\n\r\n  ImgElement.createList({\r\n    files,\r\n    hide: true,\r\n    warnOnFail: true,\r\n    onComplete: completeGenerate(parameters)\r\n  });\r\n};\r\n\r\nconst saveResult = () => {\r\n  if (!gridImage) return;\r\n\r\n  p.save(gridImage, `grid-image.png`);\r\n};\r\n\r\n// ---- setup -----------------------------------------------------------------\r\n\r\nconst setupDropZone = () => {\r\n  const thumbnails = ThumbnailArea.create({\r\n    position: Settings.thumbnailAreaPosition,\r\n    size: Settings.thumbnailAreaSize,\r\n    initialColumns: 4\r\n  });\r\n\r\n  const onAddThumbnail = (img: p5.Element, file: p5.File) => {\r\n    img.style(\"pointer-events\", \"none\");\r\n    imageFiles.push(file);\r\n  };\r\n  const onDrop = (file: p5.File) =>\r\n    ThumbnailArea.add(thumbnails, file, onAddThumbnail);\r\n\r\n  DropZone.create({\r\n    position: Settings.dropZonePosition,\r\n    size: Settings.dropZoneSize,\r\n    onDrop\r\n  });\r\n};\r\n\r\nconst setupButtons = () => {\r\n  Button.create({\r\n    label: \"generate\",\r\n    onClick: startGenerate,\r\n    position: Settings.generateButtonPosition,\r\n    size: Settings.generateButtonSize\r\n  }).style(\"font-size\", \"large\");\r\n\r\n  Button.create({\r\n    label: \"save\",\r\n    onClick: saveResult,\r\n    position: Settings.saveButtonPosition,\r\n    size: Settings.saveButtonSize\r\n  }).style(\"font-size\", \"large\");\r\n};\r\n\r\nconst setupParameterArea = () => {\r\n  parameterArea = TextArea.create({\r\n    position: Settings.parameterAreaPosition,\r\n    size: Settings.parameterAreaSize,\r\n    initialValue: Parameters.defaultString\r\n  });\r\n\r\n  parameterArea.elt.addEventListener(\"mouseenter\", () => {\r\n    guideMode = true;\r\n    Guide.draw(Parameters.parse(parameterArea.value().toString()));\r\n  });\r\n  parameterArea.elt.addEventListener(\"mouseleave\", () => {\r\n    guideMode = false;\r\n    drawGeneratedGrid();\r\n  });\r\n\r\n  let parameterAreaValue = Parameters.defaultString;\r\n  setInterval(() => {\r\n    if (!guideMode) return;\r\n\r\n    const currentValue = parameterArea.value().toString();\r\n    if (currentValue === parameterAreaValue) return;\r\n\r\n    drawGeneratedGrid();\r\n    Guide.draw(Parameters.parse(currentValue));\r\n\r\n    parameterAreaValue = currentValue;\r\n  }, 100);\r\n};\r\n\r\nconst setup = () => {\r\n  const { width, height } = Settings.canvasSize;\r\n  const canvas = p.createCanvas(width, height);\r\n  setPosition(canvas, Settings.canvasPosition);\r\n\r\n  p.imageMode(p.CENTER);\r\n\r\n  setupDropZone();\r\n  setupButtons();\r\n  setupParameterArea();\r\n\r\n  p.background(255);\r\n  Guide.draw(Parameters.defaultValues);\r\n};\r\n\r\nnew p5(p5Instance => {\r\n  setP5Instance(p5Instance);\r\n  p.setup = setup;\r\n}, document.getElementById(\"ImageGridResult\") || document.body);\r\n"],"names":["create","DomUtility.setInBox","ImgElement.create","Parameters.calculate","ImageGrid.create","Parameters.parse","ImgElement.createList","ThumbnailArea.create","Settings.thumbnailAreaPosition","Settings.thumbnailAreaSize","ThumbnailArea.add","DropZone.create","Settings.dropZonePosition","Settings.dropZoneSize","Button.create","Settings.generateButtonPosition","Settings.generateButtonSize","Settings.saveButtonPosition","Settings.saveButtonSize","TextArea.create","Settings.parameterAreaPosition","Settings.parameterAreaSize","Parameters.defaultString","Guide.draw","Settings.canvasSize","Settings.canvasPosition","Parameters.defaultValues"],"mappings":"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"}